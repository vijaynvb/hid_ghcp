{
  "info": {
    "name": "Task Management API Test Suite",
    "description": "Postman collection covering authentication, user, and task endpoints exposed by the Spring Boot backend. Run the requests in order to provision prerequisite data and reuse environment variables.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Auth",
      "item": [
        {
          "name": "Login Success",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"admin\",\n  \"password\": \"admin\"\n}"
            },
            "url": "{{baseUrl}}/auth/login"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status code is 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "pm.test('Response contains accessToken', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.have.property('accessToken');",
                  "    pm.expect(responseJson.accessToken).to.be.a('string').and.to.have.length.above(0);",
                  "});",
                  "pm.test('Auth token is stored for reuse', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.environment.set('authToken', responseJson.accessToken);",
                  "    pm.expect(pm.environment.get('authToken')).to.be.a('string');",
                  "});",
                  "pm.test('Response time within 1s', function () {",
                  "    pm.expect(pm.response.responseTime).to.be.below(1000);",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Login Invalid Credentials",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"admin\",\n  \"password\": \"wrong-password\"\n}"
            },
            "url": "{{baseUrl}}/auth/login"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status code is 401 for invalid login', function () {",
                  "    pm.response.to.have.status(401);",
                  "});",
                  "pm.test('Error body contains message', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.have.property('message', 'Invalid username or password');",
                  "    pm.expect(responseJson).to.have.property('timestamp');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Login Missing Username",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"password\": \"admin\"\n}"
            },
            "url": "{{baseUrl}}/auth/login"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status code is 400 when username missing', function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "pm.test('Validation message is present', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.have.property('message');",
                  "    pm.expect(responseJson.message.toLowerCase()).to.include('username');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Current User",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": "{{baseUrl}}/auth/me"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status code is 200 for current user', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "pm.test('Response contains expected user profile', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.have.property('username', 'admin');",
                  "    pm.expect(responseJson).to.have.property('role');",
                  "});",
                  "pm.test('Auth token reuse confirmed', function () {",
                  "    const token = pm.environment.get('authToken');",
                  "    pm.expect(token).to.be.a('string');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Current User Missing Token",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/auth/me"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status code is 401 when token missing', function () {",
                  "    pm.response.to.have.status(401);",
                  "});",
                  "pm.test('Error message indicates missing bearer token', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.have.property('message');",
                  "    pm.expect(responseJson.message.toLowerCase()).to.include('bearer');",
                  "});"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Users",
      "item": [
        {
          "name": "List Users",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": "{{baseUrl}}/users"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status code is 200 for list users', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "pm.test('Response is an array of users', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.be.an('array');",
                  "    if (responseJson.length > 0) {",
                  "        pm.expect(responseJson[0]).to.have.property('username');",
                  "    }",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Create User",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"user-{{$randomInt}}\",\n  \"displayName\": \"{{$randomFirstName}} {{$randomLastName}}\",\n  \"email\": \"user{{$randomInt}}@example.com\",\n  \"role\": \"Employee\",\n  \"teamId\": null\n}"
            },
            "url": "{{baseUrl}}/users"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status code is 201 for user creation', function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "pm.test('Created user payload captured', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.include.keys('id', 'username', 'displayName', 'email', 'role');",
                  "    pm.environment.set('userId', responseJson.id);",
                  "    pm.environment.set('userUsername', responseJson.username);",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Get User",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": "{{baseUrl}}/users/{{userId}}"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status code is 200 for get user', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "pm.test('User id matches stored value', function () {",
                  "    const responseJson = pm.response.json();",
                  "    const expectedId = pm.environment.get('userId');",
                  "    pm.expect(responseJson.id).to.eql(expectedId);",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Update User",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"id\": \"{{userId}}\",\n  \"username\": \"{{userUsername}}\",\n  \"displayName\": \"Updated {{userUsername}}\",\n  \"email\": \"updated.{{userUsername}}@example.com\",\n  \"role\": \"Manager\",\n  \"teamId\": \"11111111-1111-1111-1111-111111111111\"\n}"
            },
            "url": "{{baseUrl}}/users/{{userId}}"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status code is 200 for update user', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "pm.test('User fields reflect updates', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson.role).to.eql('Manager');",
                  "    pm.expect(responseJson.displayName).to.match(/^Updated /);",
                  "    pm.expect(responseJson.email).to.include('@example.com');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Create User Missing Username",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"displayName\": \"Missing Username\",\n  \"email\": \"missing@example.com\",\n  \"role\": \"Employee\"\n}"
            },
            "url": "{{baseUrl}}/users"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status code is 400 for missing username', function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "pm.test('Validation message identifies username', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson.message.toLowerCase()).to.include('username');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Get User Not Found",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": "{{baseUrl}}/users/00000000-0000-0000-0000-000000000000"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status code is 500 for missing user', function () {",
                  "    pm.response.to.have.status(500);",
                  "});",
                  "pm.test('Error payload indicates internal error', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.have.property('code', 'INTERNAL_ERROR');",
                  "    pm.expect(responseJson).to.have.property('message');",
                  "});"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Tasks",
      "item": [
        {
          "name": "List Tasks",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/tasks"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status code is 200 for list tasks', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "pm.test('Tasks list is an array', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.be.an('array');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Create Task",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Postman Task {{$timestamp}}\",\n  \"description\": \"Created via Postman collection test\",\n  \"priority\": \"High\",\n  \"assigneeId\": \"{{userId}}\",\n  \"tags\": [\n    \"postman\",\n    \"automation\"\n  ]\n}"
            },
            "url": "{{baseUrl}}/tasks"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status code is 201 for task creation', function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "pm.test('Task payload stored for follow-up', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.include.keys('id', 'title', 'priority');",
                  "    pm.environment.set('taskId', responseJson.id);",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Get Task",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/tasks/{{taskId}}"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status code is 200 for get task', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "pm.test('Task id matches stored taskId', function () {",
                  "    const responseJson = pm.response.json();",
                  "    const expectedTaskId = pm.environment.get('taskId');",
                  "    pm.expect(responseJson.id).to.eql(expectedTaskId);",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Replace Task",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Replaced Task {{$timestamp}}\",\n  \"description\": \"Task replaced via automated test\",\n  \"priority\": \"Medium\",\n  \"assigneeId\": \"{{userId}}\",\n  \"tags\": [\n    \"updated\",\n    \"postman\"\n  ]\n}"
            },
            "url": "{{baseUrl}}/tasks/{{taskId}}"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status code is 200 for replace task', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "pm.test('Task fields updated as expected', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson.priority).to.eql('Medium');",
                  "    pm.expect(responseJson.tags).to.be.an('array').that.includes('updated');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Update Task (Patch)",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"description\": \"Patched description from collection\"\n}"
            },
            "url": "{{baseUrl}}/tasks/{{taskId}}"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status code is 200 for patch task', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "pm.test('Patched task still returns id', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.have.property('id');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Delete Task",
          "request": {
            "method": "DELETE",
            "url": "{{baseUrl}}/tasks/{{taskId}}"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status code is 204 for delete task', function () {",
                  "    pm.response.to.have.status(204);",
                  "});",
                  "pm.test('Response body empty after delete', function () {",
                  "    pm.expect(pm.response.text()).to.be.empty;",
                  "    pm.environment.unset('taskId');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Create Task Missing Title",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"description\": \"Missing title should fail\"\n}"
            },
            "url": "{{baseUrl}}/tasks"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status code is 400 for missing title', function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "pm.test('Validation message mentions title', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson.message.toLowerCase()).to.include('title');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Get Task Not Found",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/tasks/00000000-0000-0000-0000-000000000001"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status code is 500 when task missing', function () {",
                  "    pm.response.to.have.status(500);",
                  "});",
                  "pm.test('Error payload present for missing task', function () {",
                  "    const responseJson = pm.response.json();",
                  "    pm.expect(responseJson).to.have.property('code');",
                  "    pm.expect(responseJson).to.have.property('message');",
                  "});"
                ]
              }
            }
          ]
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:9095"
    }
  ]
}
